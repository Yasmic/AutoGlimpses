<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yasmi">
<meta name="dcterms.date" content="2023-09-16">
<meta name="description" content="DCM">

<title>Diagnostic communication manager</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Autosar/DEM.html" rel="next">
<link href="../Autosar/index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ebbede3f255f00f2ca408d38e0ffdffb.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-3adbfa4ea70e1c565c7d044c4b55f33e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-5ZQX02R26E"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5ZQX02R26E', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="Diagnostic communication manager">
<meta property="og:description" content="DCM">
<meta property="og:image" content="http://localhost:4200/Autosar/Images/DCM.png">
<meta property="og:image:alt" content="DCM module position in Autosar architecture">
<meta property="og:image:height" content="946">
<meta property="og:image:width" content="1218">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text"><i class="fa-solid fa-house" aria-label="house"></i> Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Autosar/index.html"> 
<span class="menu-text"><i class="fa-solid fa-book-open-reader" aria-label="book-open-reader"></i> Autosar</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../C_Plus_Plus/index.html"> 
<span class="menu-text"><i class="fa-solid fa-user-ninja" aria-label="user-ninja"></i> C Plus Plus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Notes/index.html"> 
<span class="menu-text"><i class="fa-solid fa-file-powerpoint" aria-label="file-powerpoint"></i> Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text"><i class="fa-solid fa-address-card" aria-label="address-card"></i> About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Yasmic/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/yasmic/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Autosar/index.html">Autosar</a></li><li class="breadcrumb-item"><a href="../Autosar/DCM.html">Diagnostic communication manager</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Autosar/index.html">Autosar</a></li><li class="breadcrumb-item"><a href="../Autosar/DCM.html">Diagnostic communication manager</a></li></ol></nav>
      <h1 class="title">Diagnostic communication manager</h1>
                  <div>
        <div class="description">
          DCM
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Diagnostics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Yasmi </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 16, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../Autosar/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Autosar</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Autosar/DCM.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Diagnostic communication manager</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Autosar/DEM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diagnostic event manager</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#description" id="toc-description" class="nav-link active" data-scroll-target="#description"><span class="header-section-number">1</span> Description:</a>
  <ul>
  <li><a href="#nrcnegative-response-code" id="toc-nrcnegative-response-code" class="nav-link" data-scroll-target="#nrcnegative-response-code"><span class="header-section-number">1.1</span> NRC(Negative response code)</a></li>
  <li><a href="#dcm-submodules" id="toc-dcm-submodules" class="nav-link" data-scroll-target="#dcm-submodules"><span class="header-section-number">1.2</span> DCM Submodules</a>
  <ul>
  <li><a href="#dsl" id="toc-dsl" class="nav-link" data-scroll-target="#dsl"><span class="header-section-number">1.2.1</span> DSL</a></li>
  <li><a href="#use-cases" id="toc-use-cases" class="nav-link" data-scroll-target="#use-cases"><span class="header-section-number">1.2.2</span> Use cases</a></li>
  <li><a href="#interactions-with-other-modules" id="toc-interactions-with-other-modules" class="nav-link" data-scroll-target="#interactions-with-other-modules"><span class="header-section-number">1.2.3</span> Interactions with other modules</a></li>
  <li><a href="#dsl-important-functionalities" id="toc-dsl-important-functionalities" class="nav-link" data-scroll-target="#dsl-important-functionalities"><span class="header-section-number">1.2.4</span> DSL important Functionalities</a>
  <ul>
  <li><a href="#request-handling" id="toc-request-handling" class="nav-link" data-scroll-target="#request-handling"><span class="header-section-number">1.2.4.1</span> Request handling</a></li>
  <li><a href="#response-handling" id="toc-response-handling" class="nav-link" data-scroll-target="#response-handling"><span class="header-section-number">1.2.4.2</span> Response Handling :</a></li>
  <li><a href="#security-level-handling" id="toc-security-level-handling" class="nav-link" data-scroll-target="#security-level-handling"><span class="header-section-number">1.2.4.3</span> Security level handling</a></li>
  <li><a href="#session-state-handling" id="toc-session-state-handling" class="nav-link" data-scroll-target="#session-state-handling"><span class="header-section-number">1.2.4.4</span> Session state handling</a></li>
  <li><a href="#communication-mode-handling" id="toc-communication-mode-handling" class="nav-link" data-scroll-target="#communication-mode-handling"><span class="header-section-number">1.2.4.5</span> Communication mode handling</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#dsd-diagnostic-service-dispatcher" id="toc-dsd-diagnostic-service-dispatcher" class="nav-link" data-scroll-target="#dsd-diagnostic-service-dispatcher"><span class="header-section-number">1.3</span> DSD-Diagnostic Service dispatcher</a>
  <ul>
  <li><a href="#use-cases-1" id="toc-use-cases-1" class="nav-link" data-scroll-target="#use-cases-1"><span class="header-section-number">1.3.1</span> Use cases</a></li>
  </ul></li>
  <li><a href="#diagnostic-service-processing-dsp" id="toc-diagnostic-service-processing-dsp" class="nav-link" data-scroll-target="#diagnostic-service-processing-dsp"><span class="header-section-number">1.4</span> Diagnostic Service Processing-DSP</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="description" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="description"><span class="header-section-number">1</span> Description:</h2>
<ul>
<li><p>Diagnostic session control module ensures diagnostic data flow and manages the diagnostic states, especially diagnostic sessions and security states .</p></li>
<li><p>The DCM module provides the OSI-layers 5 to 7</p></li>
<li><p>OSI Layers and Diagnostic Protocols linking</p>
<ul>
<li>7- <code>UDS 14229</code></li>
<li>6-</li>
<li>5- <code>ISO 15765-3</code> - UDS on CAN</li>
<li>4- <code>ISO 15765-2</code></li>
<li>3- <code>ISO 15765-2</code></li>
<li>2- <code>CAN procotol</code>, <code>LIN Protocol</code>, <code>Flexray</code>, <code>MOST</code></li>
<li>1- <code>CAN procotol</code>, <code>LIN Protocol</code>, <code>Flexray</code>, <code>MOST</code> <img src="../Autosar/Images/DCM.png" class="img-fluid" alt="DCM module position in Autosar architecture"></li>
</ul></li>
<li><p>The <code>dcm</code> module receives diagnostic messages from the <code>pdur</code> module . once the dcm gets all the data it sends a message back throught he <code>PduR</code> module</p></li>
<li><p>Pdur (protocol data unit router) : The PduR module provides functions to trasmit and receive diagnositc data</p></li>
<li><p>Communication Manager(ComM): The ComM module provides functions such that the dcm can indicate the states “active” and “inactive” for diagnostic communication</p></li>
<li><p>DCM handles the communication requirements such as Full/Silent/No-Communication. dcm module provides the functionality to enable and disable diagnositc communication if requested by the ComM module.</p></li>
<li><p>DCM indicates to the BswM a communication mode change and notifies if the dcm is initailised due to jump from bootloader to application</p></li>
</ul>
<section id="nrcnegative-response-code" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="nrcnegative-response-code"><span class="header-section-number">1.1</span> NRC(Negative response code)</h3>
<p>If the diagnostic service is not sucesful due to any reason the corresponding NRC will be set and sent along with response to the diagnostic request</p>
</section>
<section id="dcm-submodules" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="dcm-submodules"><span class="header-section-number">1.2</span> DCM Submodules</h3>
<ul>
<li>DCM is devided in to 3 parts</li>
</ul>
<ol type="1">
<li>DSL-Diagnostic Session Layer</li>
</ol>
<ul>
<li>controls diagnostic protocol timing and manages the security and sessions</li>
</ul>
<ol start="2" type="1">
<li>Diagnostic Service Dispatcher</li>
</ol>
<ul>
<li>receives new diagnositc request over a network and forwards it to a data processor</li>
<li>Transmits a diagnositc response over a netowork when triggered by the data processor(DSP)</li>
</ul>
<ol start="3" type="1">
<li>Diagnostic Service Processing</li>
</ol>
<ul>
<li>The DSP submodule handles the actual diagnostic service requests . <img src="../Autosar/Images/DCM_Submodules.png" class="img-fluid" alt="DCM submodule interactions"></li>
</ul>
<section id="dsl" class="level4" data-number="1.2.1">
<h4 data-number="1.2.1" class="anchored" data-anchor-id="dsl"><span class="header-section-number">1.2.1</span> DSL</h4>
</section>
<section id="use-cases" class="level4" data-number="1.2.2">
<h4 data-number="1.2.2" class="anchored" data-anchor-id="use-cases"><span class="header-section-number">1.2.2</span> Use cases</h4>
<ul>
<li>Sessions handling as required by ISO 14229 and ISO 15765-3</li>
<li>Application layer timing handling as required by ISO 14229 and ISO 15765-3</li>
<li>Specific response behabiors as required by iso 14229 and iso 15765-3</li>
</ul>
</section>
<section id="interactions-with-other-modules" class="level4" data-number="1.2.3">
<h4 data-number="1.2.3" class="anchored" data-anchor-id="interactions-with-other-modules"><span class="header-section-number">1.2.3</span> Interactions with other modules</h4>
<p>The DSL has the following interaction wwith other modules : ##### PduR Module : - PduR module provides data of incoming diagnostic requests - The DSL submodule triggers output of diagnostic responses ##### DSD Submodule : - The DSL informs the dsd about incoming requests and provides the data - the DSD submodule triggers output of diagnostic responses ##### DSP submodule : - The DSL provides access to security and session state ##### ComM module : - The DSL guarantees the communication behavior required by the ComM module</p>
</section>
<section id="dsl-important-functionalities" class="level4" data-number="1.2.4">
<h4 data-number="1.2.4" class="anchored" data-anchor-id="dsl-important-functionalities"><span class="header-section-number">1.2.4</span> DSL important Functionalities</h4>
<section id="request-handling" class="level5" data-number="1.2.4.1">
<h5 data-number="1.2.4.1" class="anchored" data-anchor-id="request-handling"><span class="header-section-number">1.2.4.1</span> Request handling</h5>
<ul>
<li>Forwards request from the PduR module to DSD</li>
<li>Concurrent test present (Keep alive logic - 3E service from ISO 14229) - if the 3E service requested with suppressPosRspMsgIndication bit set to be true (subfunction 0x80) ,DSL reset S3 server timing. also it shall not forward this request to DSD fof further interpretation</li>
</ul>
</section>
<section id="response-handling" class="level5" data-number="1.2.4.2">
<h5 data-number="1.2.4.2" class="anchored" data-anchor-id="response-handling"><span class="header-section-number">1.2.4.2</span> Response Handling :</h5>
<ul>
<li><p>Forwards responses from the dsd to the PduR - via api PduR_DcmTransmit</p></li>
<li><p>Guarantee response timing to tester if the service takes more time to respond then DSL shall send NRC 0x78 when reaching the response time P2 server max( <code>DcmDspSessionP2ServerMax</code>) from the next 0x78 waits for P2* server time<code>DcmDspSessionP2StarServerMax</code> . DSL sends the negative responses as required from a separate buffer. The Max number of response pending(0x78) is configurable using <code>DcmDslDiagRespMaxNumRespPend</code> in order to avoid the deadlocks in the application. Once it reaches the Resp pending counter it shall send NRC (0x10) indicating general reject.</p></li>
</ul>
</section>
<section id="security-level-handling" class="level5" data-number="1.2.4.3">
<h5 data-number="1.2.4.3" class="anchored" data-anchor-id="security-level-handling"><span class="header-section-number">1.2.4.3</span> Security level handling</h5>
<ul>
<li>Manage security level</li>
</ul>
</section>
<section id="session-state-handling" class="level5" data-number="1.2.4.4">
<h5 data-number="1.2.4.4" class="anchored" data-anchor-id="session-state-handling"><span class="header-section-number">1.2.4.4</span> Session state handling</h5>
<ul>
<li><p>Manage session state :DSL get the current active session via <code>Dcm_GetSesCtrlType()</code> and set a new session through <code>DslInternal_SetSesCtrlType()</code> During dcm initialisation the default state is et which is <code>Default session</code>(0x01) when ever a non deault session is active and when the session timeout <code>(S3 server)</code>timing reaches without receiving any diag request , the DSL shall reset to the deault session by calling mode switch api of mode switch interface</p></li>
<li><p>Keep track of active nond efault sessions</p></li>
<li><p>Allow modifying timings DCM mdoule handle the following protocol timing parameter <code>P2ServerMin</code>,<code>P2ServerMax</code>,<code>P2*ServerMin</code>,<code>P2*ServerMax</code>,<code>S3Server</code> Generally these parameter set as</p></li>
</ul>
</section>
<section id="communication-mode-handling" class="level5" data-number="1.2.4.5">
<h5 data-number="1.2.4.5" class="anchored" data-anchor-id="communication-mode-handling"><span class="header-section-number">1.2.4.5</span> Communication mode handling</h5>
<ul>
<li>Handling of Full/Silent/No Communication</li>
<li>Indicating of active/inactive diagnostic</li>
<li>Enabling/Disabling all kinds of diagnostic transmissions</li>
</ul>
</section>
</section>
</section>
<section id="dsd-diagnostic-service-dispatcher" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="dsd-diagnostic-service-dispatcher"><span class="header-section-number">1.3</span> DSD-Diagnostic Service dispatcher</h3>
<p>It checks the validity of an incoming diagnostic request such as - Verification of diagnostic session - Security access levels - Application permission And keeps track of the progress of a service request execution</p>
<p>The DSD shall process only valid requests and shall reject invalid ones</p>
<section id="use-cases-1" class="level4" data-number="1.3.1">
<h4 data-number="1.3.1" class="anchored" data-anchor-id="use-cases-1"><span class="header-section-number">1.3.1</span> Use cases</h4>
<ul>
<li><p>Receive a request message and transmit positive response message</p>
<ul>
<li>The <code>DSD</code> ensures the validity of the request message.In this case if the request is valid the response will be positive .The request will be forwarded to the data process in the <code>DSP</code>. after <code>DSP</code> completes it triggers the transmission of response message by the <code>DSD</code>. If the response processing takes more time by the <code>DSP</code> may be waiting for read/write operation to eeprom then the response pending is covered by the <code>DSL</code> . When the request diag received the corresponding <code>DcmPduId</code> is blocked by the DSL .During the processing of this request , no other request of the same protocol type can be received, until the corresponding response message is sent and the <code>DcmPduId</code> if released again</li>
</ul></li>
<li><p>Receive a request message and supress the positive response</p>
<ul>
<li>If the suppress positive response bit is set in the diag request in msb bit of sub function parameter .this kind of message completely handled by the DSD</li>
</ul></li>
<li><p>Receieve a request message and suppress the negative response</p>
<ul>
<li>In case of <code>functional addressing</code> the DSD shall suppress the negative response for NRC 0x11 , 0x12 and 0x31</li>
</ul></li>
<li><p>Receive a request messahe and trasmit the negative response message</p>
<ul>
<li>Diag request is not valid or any condition not met to send the positive response the negative responses will be sent . In this case the DSP trigger a negative response with nrc indicating why the request was rejected . In case of 0x22 service if more than one did read operation is requested and if not all of the requested read did not failed only for the passed did the response will be sent .</li>
</ul></li>
<li><p>Send a positive response message without corresponding request</p>
<ul>
<li>There are two services in the UDS protocol where multiole responses are sent for only one request . One service is used to enable(and disable)an event or time triggered transmission of another service , which is sent byt he ECU without a corresponding request.<br> These services are <br>
<ul>
<li>Read Data by periodic identifier(0x2A)</li>
<li>Reponse on Event(0x86) These service handling is controlled by the DSL.However,DSD also provides the possibility to generate a response without a corresponding request.</li>
</ul></li>
</ul></li>
<li><p>Segemented responses(Paged buffer):</p>
<ul>
<li>Services such as 0x19 and 0x36 exchange huge amount of data. So in this case the ecu internal buffer must be large enough to keep the longest data message which is to be exchnaged and the complete buffer is filled before the transmission is started . In a more RAM memory saving approach the buffer is filled only partly , transmitted partly and then refilled partly and so on. This paging mechanism rewuires only a reduced amount of memory but demands a well defined reaction time for buffer refilling . The user can decide whether to use the linear buffer or paged bugger for diagnostic</li>
</ul>
<p>#### DSD interaction with other modules</p>
<ul>
<li>Delegates the processing of request to the DSP</li>
<li>Keeps track of request processing</li>
<li>Transmit the response of the application to the DSL</li>
</ul>
<p>#### Functional description</p>
<ul>
<li>The DSD shall be triggered by the DSL , if a new diagnostic message is recognised .</li>
<li>The DSD will sart processing by analyzing the diagnostic service indentifier contained in the received diagnositc message</li>
<li>if the newly received the diagnositc request sid is not supported then the DSD shall transmit the negative response with NRC 0x11 to the DSL.</li>
<li><code>Verification Functionality</code> :The DSD accept service only if below 3 verifications are passed
<ul>
<li><p>Verification of the Diagnostic session: On receiving the uds request dsd gets the current diagnostic session using api <code>Dcm_GetSesCtrlType</code> and verify whether the requested service and sub function are allowed in the current diagnostic session or not . (Note :0x10 service handling not part of DSD) If the received diag service is not allowed in the current diag session the DSD transmit the negative response with NRC 0x7F (service not supported in the active session)to the DSL submodule. If the received diag service is allowed in the current diag session but the sub function is not allowed in the current diag session then the DSD transmit the negative response with NRC 0x7E (sub function not supported in the active session)to the DSL submodule.</p></li>
<li><p>Verification of the service security access levels:</p>
<ul>
<li>The DSD checks the current security level with api <code>Dcm_GetSecurityLevel()</code> If the received diag service is not allowed in the current security level then the DSD shall transmit negative response with NRC 0x33 (Security access denied) to the DSL submodule</li>
</ul>
<p>If the received diag service is n allowed in the current security level but the requested sub function is not allowed then the DSD shall transmit negative response with NRC 0x33 (Security access denied) to the DSL submodule DSD checks whether subfunction supported , if not supported NRC 0x12 will be sent .<br> DSD checks minimum message length<br></p></li>
<li><p>Verification of the application environment/Permission Before processing the diag request the application requested to check permission /environment eg: if ecu is in run state the diag service execution not allowed , vehicle speed is higher then the service is not allowed to execute(eg : service 11)</p></li>
</ul></li>
</ul></li>
<li><p>The DSD pass the diag request to DSP service interpretor</p></li>
<li><p>The execution of the DSP service interpreter can have the results</p>
<ul>
<li>Positive result or</li>
<li>Negative result</li>
</ul></li>
<li><p>Following possible responses can be assembled</p>
<ul>
<li><p>Positive response : <code>DSP</code> indicate calling <code>Dcm_ExternalProcessingDone</code>().The parameter <code>Dcm_MsgContextType</code> contains the diagnostic (response)messgae . Then the <code>DSD</code> adds the <code>response SID</code>and then response data stream (returned by the application)in the parameter <code>Dcm_MsgContextType</code><br></p></li>
<li><p>Negative response : The DSP triggers specific NRC to the DSD . The DSD handle all the supported NRC from the application and defined in the <code>Dcm_NegativeResponseCodeType</code>.</p></li>
<li><p>Suppression of response in case of a negative result of the execution and active functional addressing the dsd submodule shall activate the suppression of the following negative responses:</p></li>
</ul>
<ol type="1">
<li>NRC 0x011 - service not supported</li>
<li>NRC 0x12 - subfunction not supported</li>
<li>NRC 0x31 - request out of range</li>
</ol>
<ul>
<li>no Response :</li>
<li>Initiate transmission
<ul>
<li>the DSD shall forward the diagnostic(response)message (positive or negative response) to the DSL.</li>
<li>the DSL shall forward the diagnostic(response)message (positive or negative response)further to the PduR module by executing a DSL transmit functionality.</li>
<li>The <code>DSL</code> will receive the confirmation by the <code>PduR</code> upon forwarding the dada
<ol type="1">
<li>the <code>DSL</code> shall forward the received confirmation from the <code>PduR</code> to the <code>dsd</code> submodule.</li>
<li>the <code>dsd</code> shall forward the confirmation via the internal function <code>DspInternal_DcmConfirmation()</code> to the <code>DSP</code> submodule.</li>
<li>In case no diagnostic(response)message shall be sent(suppression of responses)the DSL submodule shall not transmit any response.</li>
</ol></li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="diagnostic-service-processing-dsp" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="diagnostic-service-processing-dsp"><span class="header-section-number">1.4</span> Diagnostic Service Processing-DSP</h3>
<p>When dsd request the dsp to process the diag request .it executed following basic process 1. analyze the received request message 2. check format and whether the addressed subfunction is supported 3. aquire data or execute the required function call on the DEM, SW-Cs or other BSW modules 4. assemble the response</p>
<ul>
<li><p>The DSP submodule will check for appropriate message length and structure before executing the requested command . the DSP triggers a negative response with NRC 0x13 when the analysis of the request message results in formatting or length failure.</p></li>
<li><p>if the paged-buffer mechanism is used the DSP submodule shall determine the overall response length before any data is passed to the DSD submodule respectively. The DSP submodule shall confirm the completion of the request processing with the function call Dcm_ExternalProcessingDone()</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("http:\/\/localhost:4200\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "Yasmic/AutoGlimpses";
    script.dataset.repoId = "R_kgDOJ8MoGA";
    script.dataset.category = "Announcements";
    script.dataset.categoryId = "";
    script.dataset.mapping = "title";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../Autosar/index.html" class="pagination-link" aria-label="Autosar">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Autosar</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Autosar/DEM.html" class="pagination-link" aria-label="Diagnostic event manager">
        <span class="nav-page-text">Diagnostic event manager</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2022, Yasmi</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Yasmic/AutoGlimpses">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>